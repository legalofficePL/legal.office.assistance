<!DOCTYPE html>
<html lang="ua">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Форма – дані про ув’язнення</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 700px;
  margin: 20px auto;
  background: #fff;
  padding: 20px;
  border-radius: 6px;
}
h2 { margin-top: 0; }
.step { display: none; }
.step.active { display: block; }
label { display: block; margin-top: 12px; font-weight: bold; }
input, textarea, select { width: 100%; padding: 8px; margin-top: 4px; }
textarea { min-height: 80px; }
.buttons { margin-top: 20px; display: flex; justify-content: space-between; flex-wrap: wrap; gap:10px; }
button { padding: 10px 16px; cursor: pointer; }
.progress { height: 8px; background: #ddd; border-radius: 4px; margin-bottom: 20px; }
.progress-bar { height: 8px; background: #4caf50; width: 0%; border-radius: 4px; }
.box { border: 1px solid #ccc; padding: 12px; margin-top: 15px; border-radius: 4px; }
.preview { background: #f9f9f9; padding: 10px; white-space: pre-wrap; }
</style>
</head>

<body>
<div class="container">

<div class="progress">
  <div class="progress-bar" id="progressBar"></div>
</div>

<form id="form">

<!-- КРОК 1 -->
<div class="step active">
  <h2>Особисті дані</h2>
  <label>Ім’я</label><input name="Ім’я">
  <label>Прізвище</label><input name="Прізвище">
  <label>Період перебування у в’язниці (з – по)</label>
  <input type="date" name="Період від"><input type="date" name="Період до">
  <label>Адреса проживання</label><textarea name="Адреса"></textarea>
</div>

<!-- КРОК 2 -->
<div class="step">
  <h2>Контактні дані та ідентифікація</h2>
  <label>Номер телефону</label><input name="Телефон">
  <label>Електронна пошта</label><input type="email" name="Email">
  <label>Податковий номер у Словенії (Davčna številka)</label><input name="NIP">
  <label>Персональний ідентифікаційний номер EMŠO</label><input name="EMSO">
</div>

<!-- КРОК 3 -->
<div class="step">
  <h2>Дані судової справи</h2>
  <label>Номер судової справи</label><input name="Справa">
  <label>Дата винесення вироку</label><input type="date" name="Дата вироку">
  <label>Місто суду</label><input name="Місто суду">
</div>

<!-- КРОК 4 -->
<div class="step">
  <h2>Мова та права</h2>
  <label>Зрозуміла вам мова</label><input name="Мова">
  <label>Чи отримували ви тюремний регламент зрозумілою для вас мовою?</label>
  <select name="Регламент"><option>ТАК</option><option>НІ</option></select>
  <label>Додаткові зауваження</label><textarea name="Зауваження"></textarea>
</div>

<!-- КРОК 5 -->
<div class="step">
  <h2>В’язниці та камери</h2>
  <div id="prisons"></div>
  <button type="button" onclick="addPrison()">+ Додати іншу в’язницю</button>
</div>

<!-- КРОК 6 -->
<div class="step">
  <h2>Попередній перегляд</h2>
  <div class="preview" id="preview"></div>
  <label><input type="checkbox" required> Підтверджую правильність наданих даних</label>
</div>

<div class="buttons">
  <button type="button" onclick="prev()">Назад</button>
  <button type="button" onclick="next()">Далі</button>
</div>

<div class="buttons">
  <button type="button" onclick="window.print()">Друк / Зберегти як PDF</button>
  <button type="button" onclick="downloadTXT()">Завантажити файл</button>
  <button type="button" onclick="copyText()">Скопіювати текст</button>
</div>

</form>
</div>

<script>
let step = 0;
const steps = document.querySelectorAll('.step');
function showStep() {
  steps.forEach((s,i)=>s.classList.toggle('active',i===step));
  document.getElementById('progressBar').style.width = ((step+1)/steps.length*100)+'%';
  if(step===steps.length-1) buildPreview();
}
function next(){if(step<steps.length-1) step++; showStep();}
function prev(){if(step>0) step--; showStep();}

function addPrison(){
  const div=document.createElement('div'); div.className='box';
  div.innerHTML=`
    <h3>В’язниця</h3>
    <label>Назва / місто</label><input name="В’язниця">
    <label>Номер камери</label><input name="Камера">
    <label>Кількість осіб у камері</label><input name="Кількість">
    <label>Площа камери (орієнтовно)</label><input name="Площа">
    <label>Опис планування камери</label><textarea name="Схема"></textarea>
  `;
  document.getElementById('prisons').appendChild(div);
}

function buildPreview(){
  const data=new FormData(document.getElementById('form'));
  let text='';
  for(let [k,v] of data.entries()){text+=k+': '+v+'\n';}
  document.getElementById('preview').textContent=text;
}
showStep();

function downloadTXT(){
  const text=document.getElementById("preview").textContent;
  const blob=new Blob([text],{type:"text/plain;charset=utf-8"});
  const link=document.createElement("a");
  link.href=URL.createObjectURL(blob);
  link.download="formularz_osadzenie.txt";
  link.click();
}
function copyText(){
  const text=document.getElementById("preview").textContent;
  navigator.clipboard.writeText(text).then(()=>{alert("Текст скопійовано. Можете вставити у повідомлення або email.");});
}
</script>

</body>
</html>
